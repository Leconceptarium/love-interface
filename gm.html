<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>GM üíî Amour Bris√©</title>
  <style>
    body { font-family: sans-serif; background: #111; color: white; padding: 20px; }
    input[type="text"] { margin: 5px; padding: 5px; }
    button { margin: 5px; padding: 5px 10px; }
    .team-block { margin-bottom: 15px; background: #222; padding: 10px; border-radius: 8px; }
    .reset { margin-top: 30px; background-color: #c00; color: white; border: none; }
    .delete { background-color: #555; color: white; }
  </style>
</head>
<body>
  <h1>Interface Game Master üíî</h1>

  <!-- ‚ûï AJOUT D‚Äô√âQUIPE -->
  <section>
    <h2>Ajouter une √©quipe</h2>
    <input type="text" id="newTeamName" placeholder="Nom d'√©quipe">
    <button onclick="ajouterEquipe()">Ajouter</button>
  </section>

  <!-- üë• LISTE DES √âQUIPES -->
  <section id="liste-equipes">
    <!-- Les √©quipes seront g√©n√©r√©es dynamiquement au chargement -->
  </section>

  <!-- üéØ CHOIX DE LA MANCHE -->
  <section>
    <h2>Choisir une manche</h2>
    <select onchange="choisirManche(this.value)">
      <option value="">-- Choisir --</option>
      <option value="rencard">Rencard ou Cauchemar</option>
      <option value="blindtest">Blind Test Toxique</option>
      <option value="cupidon">Cupidon D√©traqu√©</option>
      <option value="tentacule">Tentacule ou Tentation</option>
      <option value="impossible">Amours Impossibles</option>
    </select>
  </section>

  <!-- üßπ RESET -->
  <section>
    <button class="reset" onclick="reinitialiser()">üßπ Recommencer la partie</button>
  </section>

  <script>
    function chargerEquipesExistantes() {
      const container = document.getElementById("liste-equipes");
      container.innerHTML = "";

      let i = 1;
      while (localStorage.getItem(`team${i}name`)) {
        const name = localStorage.getItem(`team${i}name`);
        const vie = localStorage.getItem(`life${i}`) || 100;
        creerBlocEquipe(name, vie, i);
        i++;
      }
    }

    function creerBlocEquipe(nom, vie = 100, index = null) {
      const container = document.getElementById("liste-equipes");
      const teamBlock = document.createElement("div");
      teamBlock.className = "team-block";

      const teamIndex = index || (document.querySelectorAll(".team-block").length + 1);

      const input = document.createElement("input");
      input.type = "text";
      input.value = nom;
      input.onchange = () => {
        localStorage.setItem(`team${teamIndex}name`, input.value);
      };

      const plusBtn = document.createElement("button");
      plusBtn.textContent = "+1";
      plusBtn.onclick = () => ajouterPoint(teamBlock);

      const minusBtn = document.createElement("button");
      minusBtn.textContent = "-1";
      minusBtn.onclick = () => retirerPoint(teamBlock);

      const deleteBtn = document.createElement("button");
      deleteBtn.textContent = "üóëÔ∏è Supprimer";
      deleteBtn.className = "delete";
      deleteBtn.onclick = () => supprimerEquipe(teamIndex);

      teamBlock.appendChild(input);
      teamBlock.appendChild(plusBtn);
      teamBlock.appendChild(minusBtn);
      teamBlock.appendChild(deleteBtn);

      container.appendChild(teamBlock);
    }

    function ajouterEquipe() {
      const name = document.getElementById("newTeamName").value;
      if (!name) return;

      const teamIndex = document.querySelectorAll(".team-block").length + 1;
      localStorage.setItem(`team${teamIndex}name`, name);
      localStorage.setItem(`life${teamIndex}`, 100);

      creerBlocEquipe(name, 100, teamIndex);
      document.getElementById("newTeamName").value = "";
    }

    function changerNom(input) {
      const allInputs = document.querySelectorAll('.team-block input[type="text"]');
      const index = Array.from(allInputs).indexOf(input);
      if (index >= 0) {
        localStorage.setItem(`team${index + 1}name`, input.value);
      }
    }

    function ajouterPoint(block) {
      const index = Array.from(document.querySelectorAll('.team-block')).indexOf(block);
      const id = "life" + (index + 1);
      let val = parseInt(localStorage.getItem(id)) || 100;
      val = Math.min(100, val + 10);
      localStorage.setItem(id, val);
    }

    function retirerPoint(block) {
      const index = Array.from(document.querySelectorAll('.team-block')).indexOf(block);
      const id = "life" + (index + 1);
      let val = parseInt(localStorage.getItem(id)) || 100;
      val = Math.max(0, val - 10);
      localStorage.setItem(id, val);
    }

    function supprimerEquipe(index) {
      if (confirm("Supprimer cette √©quipe ?")) {
        localStorage.removeItem(`team${index}name`);
        localStorage.removeItem(`life${index}`);
        location.reload();
      }
    }

    function choisirManche(val) {
      localStorage.setItem("mancheActive", val);
    }

    function reinitialiser() {
      if (confirm("‚ö†Ô∏è Es-tu s√ªr de vouloir recommencer toute la partie ?")) {
        localStorage.clear();
        location.reload();
      }
    }

    // Au chargement : on reconstruit tous les blocs existants
    chargerEquipesExistantes();
  </script>
</body>
</html>
